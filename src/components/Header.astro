---
const pathname = Astro.url.pathname;

const isActive = (href) => {
  if (href === '/') return pathname === '/' || pathname.includes('/en/');
  return pathname === href || pathname === `${href}/`;
};
---
<header>
  <nav
    class="md:hidden fixed bottom-0 inset-x-0 z-50 border-t border-slate-200 dark:border-slate-800 bg-white/95 dark:bg-slate-900/95 backdrop-blur"
    aria-label="Mobile bottom navigation"
  >
    <ul class="grid grid-cols-4">
      <li>
        <a
          href="/"
          class:list={[
            'h-16 flex flex-col items-center justify-center gap-1 text-xs font-medium transition-colors',
            isActive('/')
              ? 'text-sky-500'
              : 'text-slate-500 dark:text-slate-400',
          ]}
        >
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12 11.204 3.046a1.125 1.125 0 0 1 1.591 0L21.75 12M4.5 9.75V19.5A1.5 1.5 0 0 0 6 21h3.75v-6h4.5v6H18a1.5 1.5 0 0 0 1.5-1.5V9.75"/>
          </svg>
          Home
        </a>
      </li>
      <li>
        <a
          href="/about"
          class:list={[
            'h-16 flex flex-col items-center justify-center gap-1 text-xs font-medium transition-colors',
            isActive('/about')
              ? 'text-sky-500'
              : 'text-slate-500 dark:text-slate-400',
          ]}
        >
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6.75a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"/>
          </svg>
          About
        </a>
      </li>
      <li>
        <a
          href="/subscribe"
          class:list={[
            'h-16 flex flex-col items-center justify-center gap-1 text-xs font-medium transition-colors',
            isActive('/subscribe')
              ? 'text-sky-500'
              : 'text-slate-500 dark:text-slate-400',
          ]}
        >
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round" d="m21.75 9-9 5.25L3.75 9m18 0A2.25 2.25 0 0 0 19.5 6.75h-15A2.25 2.25 0 0 0 2.25 9m19.5 0v6.75A2.25 2.25 0 0 1 19.5 18h-15a2.25 2.25 0 0 1-2.25-2.25V9"/>
          </svg>
          Subscribe
        </a>
      </li>
      <li>
        <button
          id="theme-toggle-mobile"
          type="button"
          class="w-full h-16 flex flex-col items-center justify-center gap-1 text-xs font-medium text-slate-500 dark:text-slate-400 transition-colors"
          aria-label="Toggle dark mode"
        >
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 1 0 21.752 15.002Z"/>
          </svg>
          Theme
        </button>
      </li>
    </ul>
  </nav>
</header>

<script>
  const applyTheme = (darkMode) => {
    document.documentElement.classList.toggle('dark', darkMode);
    localStorage.setItem('theme', darkMode ? 'dark' : 'light');
  };

  const toggleTheme = () => {
    const isDark = document.documentElement.classList.contains('dark');
    applyTheme(!isDark);
  };

  document.getElementById('theme-toggle-mobile')?.addEventListener('click', toggleTheme);
  document.getElementById('theme-toggle-desktop')?.addEventListener('click', toggleTheme);
</script>
