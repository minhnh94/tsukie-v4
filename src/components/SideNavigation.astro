---
const pathname = Astro.url.pathname;
---
<div
  id="sidebar"
  class="sticky top-0 w-16 md:w-24 shrink-0 h-screen overflow-y-auto no-scrollbar border-r border-slate-200 dark:border-slate-800 transition-all duration-300 block"
>
  <div class="h-full flex flex-col justify-between after:flex-1 after:mt-auto">
    <div class="flex-1">
      {pathname !== '/' && (
        <div class="flex justify-center my-4">
          <a href="/">
            <img class="rounded-full" src="/images/logo.png" width="32" height="32" alt="Me" />
          </a>
        </div>
      )}
    </div>
    <div class="flex-1 grow flex items-center">
      <nav class="w-full">
        <ul class="space-y-4">
          <li class="py-2">
            <a
              href="/"
              class:list={[
                'w-full h-6 flex items-center justify-center relative after:absolute after:w-0.5 after:right-0 after:top-0 after:bottom-0',
                (pathname === '/' || pathname.includes('/en/'))
                  ? 'text-sky-500 after:bg-sky-500'
                  : 'text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400',
              ]}
            >
              <span class="sr-only">Home</span>
              <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="21" height="19">
                <path fill-opacity=".16" d="M4 7v11h13V7l-6.5-5z" />
                <path d="m10.433 3.242-8.837 6.56L.404 8.198l10.02-7.44L20.59 8.194l-1.18 1.614-8.977-6.565ZM16 17V9h2v10H3V9h2v8h11Z" />
              </svg>
            </a>
          </li>
          <li class="py-2">
            <a
              href="/about"
              class:list={[
                'w-full h-6 flex items-center justify-center relative after:absolute after:w-0.5 after:right-0 after:top-0 after:bottom-0',
                pathname === '/about' || pathname === '/about/'
                  ? 'text-sky-500 after:bg-sky-500'
                  : 'text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400',
              ]}
            >
              <span class="sr-only">About</span>
              <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
                <path fill-opacity=".16" d="M10 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8Z" />
                <path d="M9 5h2v2H9V5Zm0 4h2v6H9V9Zm1-9C4.48 0 0 4.48 0 10s4.48 10 10 10 10-4.48 10-10S15.52 0 10 0Zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8Z" />
              </svg>
            </a>
          </li>
          <li class="py-2">
            <a
              href="/subscribe"
              class:list={[
                'w-full h-6 flex items-center justify-center relative after:absolute after:w-0.5 after:right-0 after:top-0 after:bottom-0',
                pathname === '/subscribe' || pathname === '/subscribe/'
                  ? 'text-sky-500 after:bg-sky-500'
                  : 'text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400',
              ]}
            >
              <span class="sr-only">Subscribe</span>
              <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="21" height="21">
                <path fill-opacity=".16" d="m13.4 18-3-7.4-7.4-3L19 2z" />
                <path d="M13.331 15.169 17.37 3.63 5.831 7.669l5.337 2.163 2.163 5.337Zm-3.699-3.801L.17 7.53 20.63.37l-7.161 20.461-3.837-9.463Z" />
              </svg>
            </a>
          </li>
        </ul>
      </nav>
    </div>
    <div class="pb-4 flex justify-center md:hidden">
      <button
        id="sidebar-toggle"
        class="w-10 h-10 flex items-center justify-center rounded border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors"
        aria-label="Hide sidebar"
      >
        <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
          <path d="M10 3L9 4l3 3-3 3 1 1 4-4-4-4z" />
        </svg>
      </button>
    </div>
  </div>
</div>

<button
  id="sidebar-show"
  class="fixed left-0 top-0 z-50 w-5 h-screen items-center justify-center rounded-r border-r border-b border-t border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors md:hidden hidden"
  aria-label="Show sidebar"
>
  <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 16 16">
    <path d="M6 3L5 4l3 3-3 3 1 1 4-4-4-4z" />
  </svg>
</button>

<script>
  const sidebar = document.getElementById('sidebar');
  const toggleBtn = document.getElementById('sidebar-toggle');
  const showBtn = document.getElementById('sidebar-show');

  if (toggleBtn && sidebar && showBtn) {
    toggleBtn.addEventListener('click', () => {
      sidebar.classList.add('hidden', 'md:block');
      showBtn.classList.remove('hidden');
      showBtn.classList.add('flex');
    });

    showBtn.addEventListener('click', () => {
      sidebar.classList.remove('hidden', 'md:block');
      showBtn.classList.add('hidden');
      showBtn.classList.remove('flex');
    });
  }
</script>
