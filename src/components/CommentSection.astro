---
---
<div id="utterances-container"></div>

<script>
  function loadUtterances() {
    const container = document.getElementById('utterances-container');
    if (!container) return;

    const isDark = document.documentElement.classList.contains('dark');
    const theme = isDark ? 'github-dark' : 'github-light';

    const script = document.createElement('script');
    script.async = true;
    script.crossOrigin = 'anonymous';
    script.src = 'https://utteranc.es/client.js';
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('repo', 'minhnh94/tsukie-blog-comments');
    script.setAttribute('theme', theme);
    container.appendChild(script);
  }

  loadUtterances();

  // Watch for theme changes to update Utterances
  const observer = new MutationObserver(() => {
    const iframe = document.querySelector('.utterances-frame') as HTMLIFrameElement;
    if (iframe) {
      const isDark = document.documentElement.classList.contains('dark');
      const theme = isDark ? 'github-dark' : 'github-light';
      iframe.contentWindow?.postMessage({ type: 'set-theme', theme }, 'https://utteranc.es');
    }
  });

  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ['class'],
  });
</script>
